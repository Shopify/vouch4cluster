package clair

import (
	"github.com/Shopify/voucher"
	"github.com/coreos/clair/api/v1"
	clairdb "github.com/coreos/clair/database"
)

// getSeverity converts a Clair serverity into a Voucher serverity.
func getSeverity(severity string) voucher.Severity {
	switch clairdb.Severity(severity) {
	case clairdb.NegligibleSeverity:
		return voucher.NegligibleSeverity
	case clairdb.LowSeverity:
		return voucher.LowSeverity
	case clairdb.MediumSeverity:
		return voucher.MediumSeverity
	case clairdb.HighSeverity:
		return voucher.HighSeverity
	case clairdb.CriticalSeverity:
		return voucher.CriticalSeverity
	}
	return voucher.UnknownSeverity
}

// vulnerabilityToVoucherVulnerability converts a Clair Vulnerability to
// a Voucher Vulnerability.
func vulnerabilityToVoucherVulnerability(clairVuln v1.Vulnerability) voucher.Vulnerability {
	severity := getSeverity(clairVuln.Severity)

	return voucher.Vulnerability{
		Name:        clairVuln.Name,
		Description: clairVuln.Description,
		FixedBy:     clairVuln.FixedBy,
		Severity:    severity,
	}
}
